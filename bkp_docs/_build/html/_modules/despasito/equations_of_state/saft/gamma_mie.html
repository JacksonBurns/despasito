

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>despasito.equations_of_state.saft.gamma_mie &mdash; DESPASITO  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> DESPASITO
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../api.html">API Documentation</a></li>
</ul>
<p class="caption"><span class="caption-text">Modules:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../input_output.html">Input/Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../eos.html">Equations of State</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../thermo.html">Thermodynamic Calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../fitparams.html">Parametrization</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">DESPASITO</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../../equations_of_state.html">despasito.equations_of_state</a> &raquo;</li>
        
      <li>despasito.equations_of_state.saft.gamma_mie</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for despasito.equations_of_state.saft.gamma_mie</h1><div class="highlight"><pre>
<span></span><span class="c1"># -- coding: utf8 --</span>

<span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    </span>
<span class="sd">    EOS object for SAFT-:math:`\gamma`-Mie</span>
<span class="sd">    Equations referenced in this code are from V. Papaioannou et al J. Chem. Phys. 140 054107 2014</span>
<span class="sd">    </span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">constants</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">gamma_mie_funcs</span> <span class="k">as</span> <span class="n">funcs</span>
<span class="c1"># Later this line will be in an abstract class file in this directory, and all versions of SAFT will reference it</span>
<span class="kn">from</span> <span class="nn">despasito.equations_of_state.interface</span> <span class="k">import</span> <span class="n">EOStemplate</span>

<span class="c1"># ________________ Saft Family ______________</span>
<span class="c1"># NoteHere: Insert SAFT family abstract class in this directory to clean up</span>


<div class="viewcode-block" id="saft_gamma_mie"><a class="viewcode-back" href="../../../../autosummary/saft.html#despasito.equations_of_state.saft.gamma_mie.saft_gamma_mie">[docs]</a><span class="k">class</span> <span class="nc">saft_gamma_mie</span><span class="p">(</span><span class="n">EOStemplate</span><span class="p">):</span>

    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize EOS with system component parameters so that methods may be used by thermodynamic calculations. All input and calculated parameters are defined as hidden attributes.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    xi : list[float]</span>
<span class="sd">        Mole fraction of component, only relevant for parameter fitting</span>
<span class="sd">    beads : list[str]</span>
<span class="sd">        List of unique bead names used among components</span>
<span class="sd">    nui : numpy.ndarray</span>
<span class="sd">        :math:`\\nu_{i,k}/k_B`. Array of number of components by number of bead types. Defines the number of each type of group in each component.</span>
<span class="sd">    beadlibrary : dict</span>
<span class="sd">        A dictionary where bead names are the keys to access EOS self interaction parameters:</span>

<span class="sd">        * epsilon: :math:`\epsilon_{k,k}/k_B`, Energy well depth scaled by Boltzmann constant</span>
<span class="sd">        * sigma: :math:`\sigma_{k,k}`, Size parameter [m]</span>
<span class="sd">        * mass: Bead mass [kg/mol]</span>
<span class="sd">        * l_r: :math:`\lambda^{r}_{k,k}`, Exponent of repulsive term between groups of type k</span>
<span class="sd">        * l_a: :math:`\lambda^{a}_{k,k}`, Exponent of attractive term between groups of type k</span>
<span class="sd">        * Sk: :math:`S_{k}`, Shape parameter of group k</span>
<span class="sd">        * Vks: :math:`V_{k,s}`, Number of groups, k, in component</span>
<span class="sd">    crosslibrary : dict, Optional, default: {}</span>
<span class="sd">        Optional library of bead cross interaction parameters. As many or as few of the desired parameters may be defined for whichever group combinations are desired.</span>

<span class="sd">        * epsilon: :math:`\epsilon_{k,l}/k_B`, Energy parameter scaled by Boltzmann Constant</span>
<span class="sd">        * l_r: :math:`\lambda^{r}_{k,l}`, Exponent of repulsive term between groups of type k and l</span>
<span class="sd">    sitenames : list[str], Optional, default: []</span>
<span class="sd">        List of unique association sites used among components</span>
<span class="sd">        </span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    T : float, default: numpy.nan</span>
<span class="sd">        Temperature value is initially defined as NaN for a placeholder until temperature dependent attributes are initialized by using a method of this class.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>

        <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

        <span class="c1"># Self interaction parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nui</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;nui&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_beads</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;beads&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_beadlibrary</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;beadlibrary&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="s2">&quot;xi&quot;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">xi</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;xi&#39;</span><span class="p">]</span>

        <span class="n">massi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">xi</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_beads</span><span class="p">)):</span>
                <span class="n">massi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nui</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beadlibrary</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_beads</span><span class="p">[</span><span class="n">k</span><span class="p">]][</span><span class="s2">&quot;mass&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_massi</span> <span class="o">=</span> <span class="n">massi</span>

        <span class="c1"># Cross interaction parameters</span>
        <span class="k">if</span> <span class="s1">&#39;crosslibrary&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">crosslibrary</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;crosslibrary&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">crosslibrary</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">epsilonkl</span><span class="p">,</span> <span class="n">sigmakl</span><span class="p">,</span> <span class="n">l_akl</span><span class="p">,</span> <span class="n">l_rkl</span><span class="p">,</span> <span class="n">Ckl</span> <span class="o">=</span> <span class="n">funcs</span><span class="o">.</span><span class="n">calc_interaction_matrices</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_beads</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beadlibrary</span><span class="p">,</span> <span class="n">crosslibrary</span><span class="o">=</span><span class="n">crosslibrary</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_crosslibrary</span> <span class="o">=</span> <span class="n">crosslibrary</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_epsilonkl</span> <span class="o">=</span> <span class="n">epsilonkl</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sigmakl</span> <span class="o">=</span> <span class="n">sigmakl</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_l_akl</span> <span class="o">=</span> <span class="n">l_akl</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_l_rkl</span> <span class="o">=</span> <span class="n">l_rkl</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Ckl</span> <span class="o">=</span> <span class="n">Ckl</span>

        <span class="c1"># Association sites</span>
        <span class="k">if</span> <span class="s1">&#39;sitenames&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sitenames</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;sitenames&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sitenames</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">epsilonHB</span><span class="p">,</span> <span class="n">Kklab</span><span class="p">,</span> <span class="n">nk</span> <span class="o">=</span> <span class="n">funcs</span><span class="o">.</span><span class="n">calc_assoc_matrices</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_beads</span><span class="p">,</span>
                                                         <span class="bp">self</span><span class="o">.</span><span class="n">_beadlibrary</span><span class="p">,</span>
                                                         <span class="n">sitenames</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_sitenames</span><span class="p">,</span>
                                                         <span class="n">crosslibrary</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_crosslibrary</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_epsilonHB</span> <span class="o">=</span> <span class="n">epsilonHB</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Kklab</span> <span class="o">=</span> <span class="n">Kklab</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nk</span> <span class="o">=</span> <span class="n">nk</span>

        <span class="c1"># Initialize temperature attribute</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="k">def</span> <span class="nf">_temp_dependent_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Temperature dependent variables are initialized or updated according to the provided temperature.</span>
<span class="sd">    </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        T : float, default: numpy.nan</span>
<span class="sd">            Temperature of the system [K]</span>
<span class="sd">    </span>
<span class="sd">        Attributes</span>
<span class="sd">        ----------</span>
<span class="sd">        T : float, default: numpy.nan</span>
<span class="sd">            Temperature of the system</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

        <span class="n">dkk</span><span class="p">,</span> <span class="n">dkl</span><span class="p">,</span> <span class="n">x0kl</span> <span class="o">=</span> <span class="n">funcs</span><span class="o">.</span><span class="n">calc_hard_sphere_matricies</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_beads</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beadlibrary</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sigmakl</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">T</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dkk</span> <span class="o">=</span> <span class="n">dkk</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dkl</span> <span class="o">=</span> <span class="n">dkl</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_x0kl</span> <span class="o">=</span> <span class="n">x0kl</span>

    <span class="k">def</span> <span class="nf">_xi_dependent_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xi</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Variables dependent on composition are initialized or updated according to the provided mole fractions.</span>
<span class="sd">    </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xi : list[float]</span>
<span class="sd">            Mole fraction of component</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

        <span class="n">Cmol2seg</span><span class="p">,</span> <span class="n">xsk</span><span class="p">,</span> <span class="n">xskl</span> <span class="o">=</span> <span class="n">funcs</span><span class="o">.</span><span class="n">calc_composition_dependent_variables</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nui</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beads</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beadlibrary</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_Cmol2seg</span> <span class="o">=</span> <span class="n">Cmol2seg</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xsk</span> <span class="o">=</span> <span class="n">xsk</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xskl</span> <span class="o">=</span> <span class="n">xskl</span>

<div class="viewcode-block" id="saft_gamma_mie.P"><a class="viewcode-back" href="../../../../autosummary/saft.html#despasito.equations_of_state.saft.gamma_mie.saft_gamma_mie.P">[docs]</a>    <span class="k">def</span> <span class="nf">P</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">xi</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute pressure given system information</span>
<span class="sd">       </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        rho : numpy.ndarray</span>
<span class="sd">            Number density of system [molecules/m^3]</span>
<span class="sd">        T : float</span>
<span class="sd">            Temperature of the system [K]</span>
<span class="sd">        xi : list[float]</span>
<span class="sd">            Mole fraction of each component</span>
<span class="sd">       </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        P : numpy.ndarray</span>
<span class="sd">            Array of pressure values [Pa] associated with each density and so equal in length</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">T</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_temp_dependent_variables</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_xi_dependent_variables</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="n">rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>

        <span class="n">step</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span> <span class="o">*</span> <span class="n">rho</span> <span class="o">*</span> <span class="mf">10000.0</span>
        <span class="c1"># Decreasing step size by 2 orders of magnitude didn&#39;t reduce noise in P values</span>
        <span class="n">nrho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>

        <span class="c1"># computer rho+step and rho-step for better a bit better performance</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">funcs</span><span class="o">.</span><span class="n">calc_A</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rho</span> <span class="o">+</span> <span class="n">step</span><span class="p">,</span> <span class="n">rho</span> <span class="o">-</span> <span class="n">step</span><span class="p">),</span> <span class="n">xi</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beads</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beadlibrary</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_massi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nui</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Cmol2seg</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xsk</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xskl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dkk</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilonkl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sigmakl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dkl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_l_akl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_l_rkl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ckl</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_x0kl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilonHB</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Kklab</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nk</span><span class="p">)</span>

        <span class="n">P_tmp</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span><span class="p">[:</span><span class="n">nrho</span><span class="p">]</span><span class="o">-</span><span class="n">A</span><span class="p">[</span><span class="n">nrho</span><span class="p">:])</span><span class="o">*</span><span class="p">((</span><span class="n">constants</span><span class="o">.</span><span class="n">kb</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">step</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">rho</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">P_tmp</span></div>

<div class="viewcode-block" id="saft_gamma_mie.chemicalpotential"><a class="viewcode-back" href="../../../../autosummary/saft.html#despasito.equations_of_state.saft.gamma_mie.saft_gamma_mie.chemicalpotential">[docs]</a>    <span class="k">def</span> <span class="nf">chemicalpotential</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute pressure given system information</span>
<span class="sd">      </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        P : float</span>
<span class="sd">            Pressure of the system [Pa]</span>
<span class="sd">        rho : float</span>
<span class="sd">            Molar density of system [mol/m^3]</span>
<span class="sd">        T : float</span>
<span class="sd">            Temperature of the system [K]</span>
<span class="sd">        xi : list[float]</span>
<span class="sd">            Mole fraction of each component</span>
<span class="sd">    </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        mui : numpy.ndarray</span>
<span class="sd">            Array of chemical potential values for each component</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">T</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_temp_dependent_variables</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_xi_dependent_variables</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>

        <span class="n">daresdxi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
        <span class="n">mui</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
        <span class="n">nmol</span> <span class="o">=</span> <span class="mf">1.0</span>

        <span class="c1"># Set step size in finite difference method</span>
        <span class="n">dnmol</span> <span class="o">=</span> <span class="mf">1.0E-4</span>
        <span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">xi_tmp</span> <span class="o">=</span> <span class="n">xi</span><span class="p">[</span><span class="n">xi</span><span class="o">!=</span><span class="mf">0.</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">xi_tmp</span><span class="o">-</span><span class="n">dnmol</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">):</span>
            <span class="n">exp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">xi_tmp</span><span class="p">)))</span><span class="o">-</span><span class="mi">2</span> <span class="c1"># Make sure step size is two orders of magnitude lower</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;    Mole fraction, </span><span class="si">{}</span><span class="s2">, is smaller than increment, </span><span class="si">{}</span><span class="s2">. Use new increment, </span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">dnmol</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="n">exp</span><span class="p">))</span>
            <span class="n">dnmol</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">exp</span>

        <span class="c1"># compute mui</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">mui</span><span class="p">)):</span>
            <span class="n">dAres</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">ares</span> <span class="o">=</span> <span class="n">funcs</span><span class="o">.</span><span class="n">calc_Ares</span><span class="p">(</span><span class="n">rho</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">Nav</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beads</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beadlibrary</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_massi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nui</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Cmol2seg</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xsk</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xskl</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_dkk</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilonkl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sigmakl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dkl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_l_akl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_l_rkl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ckl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x0kl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilonHB</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Kklab</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nk</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">delta</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">((</span><span class="n">dnmol</span><span class="p">,</span> <span class="o">-</span><span class="n">dnmol</span><span class="p">)):</span>
                <span class="n">xi_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">xi_temp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">0.</span><span class="p">:</span> <span class="n">xi_temp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">delta</span>
                <span class="n">Cmol2seg_tmp</span><span class="p">,</span> <span class="n">xsk_tmp</span><span class="p">,</span> <span class="n">xskl_tmp</span> <span class="o">=</span> <span class="n">funcs</span><span class="o">.</span><span class="n">calc_composition_dependent_variables</span><span class="p">(</span><span class="n">xi_temp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nui</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beads</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beadlibrary</span><span class="p">)</span>
                <span class="c1"># xi_temp/=(nmol+delta)</span>
                <span class="n">dAres</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">funcs</span><span class="o">.</span><span class="n">calc_Ares</span><span class="p">(</span><span class="n">rho</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">Nav</span><span class="p">,</span> <span class="n">xi_temp</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beads</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beadlibrary</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_massi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nui</span><span class="p">,</span> <span class="n">Cmol2seg_tmp</span><span class="p">,</span> <span class="n">xsk_tmp</span><span class="p">,</span> <span class="n">xskl_tmp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dkk</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilonkl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sigmakl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dkl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_l_akl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_l_rkl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ckl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_x0kl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_epsilonHB</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Kklab</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nk</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;xi dAres&quot;</span><span class="p">,</span><span class="n">xi_temp</span><span class="p">,</span><span class="n">dAres</span><span class="p">)</span>
            <span class="n">daresdxi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">dAres</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">dAres</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">dnmol</span><span class="p">)</span>

        <span class="c1"># compute Z</span>
        <span class="n">Z</span> <span class="o">=</span> <span class="n">P</span> <span class="o">/</span> <span class="p">(</span><span class="n">rho</span> <span class="o">*</span> <span class="n">T</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">Nav</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">kb</span><span class="p">)</span>
        <span class="n">xjdaresdxj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">xi</span> <span class="o">*</span> <span class="n">daresdxi</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">mui</span><span class="p">)):</span>
            <span class="n">mui</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ares</span> <span class="o">+</span> <span class="n">Z</span> <span class="o">-</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">daresdxi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">xjdaresdxj</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;xi, mu comp:&quot;</span><span class="p">,</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">mui</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">ares</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">daresdxi</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">xjdaresdxj</span><span class="p">)</span>
    
        <span class="k">return</span> <span class="n">mui</span></div>

<div class="viewcode-block" id="saft_gamma_mie.density_max"><a class="viewcode-back" href="../../../../autosummary/saft.html#despasito.equations_of_state.saft.gamma_mie.saft_gamma_mie.density_max">[docs]</a>    <span class="k">def</span> <span class="nf">density_max</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">maxpack</span><span class="o">=</span><span class="mf">0.65</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Estimate the maximum density based on the hard sphere packing fraction.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xi : list[float]</span>
<span class="sd">            Mole fraction of each component</span>
<span class="sd">        T : float</span>
<span class="sd">            Temperature of the system [K]</span>
<span class="sd">        maxpack : float, Optional, default: 0.65</span>
<span class="sd">            Maximum packing fraction</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        maxrho : float</span>
<span class="sd">            Maximum molar density [mol/m^3]</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">T</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_temp_dependent_variables</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_xi_dependent_variables</span><span class="p">(</span><span class="n">xi</span><span class="p">)</span>

        <span class="c1"># estimate the maximum density based on the hard sphere packing fraction</span>
        <span class="c1"># etax, assuming a maximum packing fraction specified by maxpack</span>
        <span class="n">maxrho</span> <span class="o">=</span> <span class="n">maxpack</span> <span class="o">*</span> <span class="mf">6.0</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Cmol2seg</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_xskl</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dkl</span><span class="o">**</span><span class="mi">3</span><span class="p">)))</span> <span class="o">/</span> <span class="n">constants</span><span class="o">.</span><span class="n">Nav</span>
        <span class="k">return</span> <span class="n">maxrho</span></div>

<div class="viewcode-block" id="saft_gamma_mie.param_guess"><a class="viewcode-back" href="../../../../autosummary/saft.html#despasito.equations_of_state.saft.gamma_mie.saft_gamma_mie.param_guess">[docs]</a>    <span class="k">def</span> <span class="nf">param_guess</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fit_params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate initial guesses for the parameters to be fit.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fit_params : list[str]</span>
<span class="sd">        A list of parameters to be fit. See EOS mentation for supported parameter names. Cross interaction parameter names should be composed of parameter name and the other bead type, separated by an underscore (e.g. epsilon_CO2).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        param_initial_guesses : numpy.ndarray, </span>
<span class="sd">            An array of initial guesses for parameters, these will be optimized throughout the process.</span>
<span class="sd">    &quot;&quot;&quot;</span>

        <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

        <span class="n">l_fitparams</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fit_params</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">l_fitparams</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">param_initial_guesses</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">l_fitparams</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">param_initial_guesses</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">l_fitparams</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">param</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fit_params</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">param</span> <span class="o">==</span> <span class="s2">&quot;epsilon&quot;</span> <span class="ow">or</span> <span class="n">param</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;epsilon_&#39;</span><span class="p">)):</span>
                <span class="n">param_initial_guesses</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">200.0</span>
            <span class="k">elif</span> <span class="n">param</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;epsilon&#39;</span><span class="p">):</span>
                <span class="n">param_initial_guesses</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1000.0</span>
            <span class="k">elif</span> <span class="n">param</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;l_a&#39;</span><span class="p">):</span>
                <span class="n">param_initial_guesses</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">6.0</span>
            <span class="k">elif</span> <span class="n">param</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;l_r&#39;</span><span class="p">):</span>
                <span class="n">param_initial_guesses</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">12.0</span>
            <span class="k">elif</span> <span class="n">param</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">):</span>
                <span class="n">param_initial_guesses</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">100.0e-30</span>
            <span class="k">elif</span> <span class="n">param</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;Sk&#39;</span><span class="p">):</span>
                <span class="n">param_initial_guesses</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The parameter name </span><span class="si">%s</span><span class="s2"> does not fall under any of the catagories, epsilon, epsilon (assoc), l_a, l_r, K (assoc), or Sk&quot;</span><span class="p">)</span> 

        <span class="k">return</span> <span class="n">param_initial_guesses</span></div>

<div class="viewcode-block" id="saft_gamma_mie.update_parameters"><a class="viewcode-back" href="../../../../autosummary/saft.html#despasito.equations_of_state.saft.gamma_mie.saft_gamma_mie.update_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">update_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param_name</span><span class="p">,</span> <span class="n">bead_names</span><span class="p">,</span> <span class="n">param_value</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update a single parameter value to _beadlibrary or _crosslibrary attributes during parameter fitting process. </span>

<span class="sd">        To refresh those parameters that are dependent on these libraries, use method &quot;parameter refresh&quot;.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        param_name : str</span>
<span class="sd">            name of parameters being updated</span>
<span class="sd">        bead_names : list</span>
<span class="sd">            List of bead names to be changed. For a self interaction parameter, the length will be 1, for a cross interaction parameter, the length will be two.</span>
<span class="sd">        param_value : float</span>
<span class="sd">            Value of parameter</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

        <span class="n">param_types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;epsilon&quot;</span><span class="p">,</span> <span class="s2">&quot;sigma&quot;</span><span class="p">,</span> <span class="s2">&quot;l_r&quot;</span><span class="p">,</span> <span class="s2">&quot;l_a&quot;</span><span class="p">,</span> <span class="s2">&quot;Sk&quot;</span><span class="p">,</span> <span class="s2">&quot;K&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bead_names</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The bead names </span><span class="si">%s</span><span class="s2"> were given, but only a maximum of 2 are permitted.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bead_names</span><span class="p">)))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">(</span><span class="n">bead_names</span><span class="p">)</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_beads</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The bead names </span><span class="si">%s</span><span class="s2"> were given, but they are not in the allowed list: &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bead_names</span><span class="p">),</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_beads</span><span class="p">)))</span>

        <span class="c1"># Non bonded parameters</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">param_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;epsilon&quot;</span><span class="p">,</span> <span class="s2">&quot;sigma&quot;</span><span class="p">,</span> <span class="s2">&quot;l_r&quot;</span><span class="p">,</span> <span class="s2">&quot;l_a&quot;</span><span class="p">,</span> <span class="s2">&quot;Sk&quot;</span><span class="p">]):</span>
            <span class="c1"># Self interaction parameter</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bead_names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_beadlibrary</span><span class="p">[</span><span class="n">bead_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">param_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">param_value</span>
            <span class="c1"># Cross interaction parameter</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">bead_names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">bead_names</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_crosslibrary</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="k">if</span> <span class="n">bead_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_crosslibrary</span><span class="p">[</span><span class="n">bead_names</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_crosslibrary</span><span class="p">[</span><span class="n">bead_names</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">bead_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">param_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">param_value</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_crosslibrary</span><span class="p">[</span><span class="n">bead_names</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span><span class="n">bead_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]:{</span><span class="n">param_name</span><span class="p">:</span><span class="n">param_value</span><span class="p">}}</span>
                <span class="k">elif</span> <span class="n">bead_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_crosslibrary</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="k">if</span> <span class="n">bead_names</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_crosslibrary</span><span class="p">[</span><span class="n">bead_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> 
                        <span class="bp">self</span><span class="o">.</span><span class="n">_crosslibrary</span><span class="p">[</span><span class="n">bead_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">bead_names</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">param_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">param_value</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_crosslibrary</span><span class="p">[</span><span class="n">bead_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span><span class="n">bead_names</span><span class="p">[</span><span class="mi">1</span><span class="p">]:{</span><span class="n">param_name</span><span class="p">:</span><span class="n">param_value</span><span class="p">}}</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_crosslibrary</span><span class="p">[</span><span class="n">bead_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span><span class="n">bead_names</span><span class="p">[</span><span class="mi">1</span><span class="p">]:{</span><span class="n">param_name</span><span class="p">:</span><span class="n">param_value</span><span class="p">}}</span>

        <span class="c1"># Association Sites</span>
        <span class="k">elif</span> <span class="nb">any</span><span class="p">([</span><span class="n">param_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;epsilon&#39;</span><span class="p">),</span> <span class="n">param_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">)]):</span>

            <span class="c1"># Ensure sitenames are valid and on list</span>
            <span class="k">if</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> <span class="n">tmp_name_full</span> <span class="o">=</span> <span class="n">param_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;epsilon&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> <span class="n">tmp_name_full</span> <span class="o">=</span> <span class="n">param_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;K&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="k">for</span> <span class="n">site1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sitenames</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">tmp_name_full</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">site1</span><span class="p">):</span>
                    <span class="n">tmp_name</span> <span class="o">=</span> <span class="n">tmp_name_full</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">site1</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">site2</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sitenames</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">tmp_name</span> <span class="o">==</span> <span class="n">site2</span><span class="p">:</span>
                            <span class="n">flag</span> <span class="o">=</span> <span class="mi">1</span>
                            <span class="k">break</span>
                    <span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">break</span>
            <span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;site_names should be two different sites in the list: </span><span class="si">%s</span><span class="s2">. You gave: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">tmp_name_full</span><span class="p">,</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sitenames</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_sitenames</span><span class="p">)))</span>

            <span class="c1"># Self interaction parameter</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bead_names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_beadlibrary</span><span class="p">[</span><span class="n">bead_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">param_name</span><span class="o">+</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">site_names</span><span class="p">)]</span> <span class="o">=</span> <span class="n">param_value</span>
            <span class="c1"># Cross interaction parameter</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">bead_names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">bead_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_crosslibrary</span><span class="p">[</span><span class="n">bead_names</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_crosslibrary</span><span class="p">[</span><span class="n">bead_names</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">bead_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">param_name</span><span class="o">+</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">site_names</span><span class="p">)]</span> <span class="o">=</span> <span class="n">param_value</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_crosslibrary</span><span class="p">[</span><span class="n">bead_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">bead_names</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">param_name</span><span class="o">+</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">site_names</span><span class="p">)]</span> <span class="o">=</span> <span class="n">param_value</span>                        

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The parameter name </span><span class="si">%s</span><span class="s2"> is not found in the allowed parameter types: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">param_name</span><span class="p">,</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">param_types</span><span class="p">)))</span></div>

<div class="viewcode-block" id="saft_gamma_mie.parameter_refresh"><a class="viewcode-back" href="../../../../autosummary/saft.html#despasito.equations_of_state.saft.gamma_mie.saft_gamma_mie.parameter_refresh">[docs]</a>    <span class="k">def</span> <span class="nf">parameter_refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        To refresh those parameters that are dependent on _beadlibrary and _crosslibrary attributes. This **must** be run after all parameters from update_parameters method have been changed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

        <span class="c1"># Update Non bonded matrices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_epsilonkl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sigmakl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_l_akl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_l_rkl</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ckl</span> <span class="o">=</span> <span class="n">funcs</span><span class="o">.</span><span class="n">calc_interaction_matrices</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_beads</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_beadlibrary</span><span class="p">,</span> <span class="n">crosslibrary</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_crosslibrary</span><span class="p">)</span>

        <span class="c1"># Update Association site matrices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_epsilonHB</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Kklab</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nk</span> <span class="o">=</span> <span class="n">funcs</span><span class="o">.</span><span class="n">calc_assoc_matrices</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_beads</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_beadlibrary</span><span class="p">,</span><span class="n">sitenames</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_sitenames</span><span class="p">,</span><span class="n">crosslibrary</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_crosslibrary</span><span class="p">)</span>

        <span class="c1"># Update temperature dependent variables</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_temp_dependent_variables</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;Beads:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_beads</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="s2">&quot;T:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">string</span></div>


</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Jennifer A Clark. Project structure based on the Computational Molecular Science Python Cookiecutter version 1.0

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>