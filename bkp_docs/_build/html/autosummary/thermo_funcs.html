

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Supporting Thermodynamic Functions &mdash; DESPASITO  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Parametrization" href="../fitparams.html" />
    <link rel="prev" title="Thermodynamic Calculations" href="../thermo.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> DESPASITO
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Documentation</a></li>
</ul>
<p class="caption"><span class="caption-text">Modules:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../input_output.html">Input/Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="../eos.html">Equations of State</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../thermo.html">Thermodynamic Calculations</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../thermo.html#module-despasito.thermodynamics.calc_types">Available Calculation Types</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Supporting Thermodynamic Functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../fitparams.html">Parametrization</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DESPASITO</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../thermo.html">Thermodynamic Calculations</a> &raquo;</li>
        
      <li>Supporting Thermodynamic Functions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/autosummary/thermo_funcs.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-despasito.thermodynamics.calc">
<span id="supporting-thermodynamic-functions"></span><h1>Supporting Thermodynamic Functions<a class="headerlink" href="#module-despasito.thermodynamics.calc" title="Permalink to this headline">¶</a></h1>
<p>This module contains our thermodynamic calculations. Calculation of pressure, chemical potential, and max density are handled by an eos object so that these functions can be used with any EOS. The thermo module contains a series of wrapper to handle the inputs and outputs of these functions.</p>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>Add types of scipy solving methods and the types available</p>
<p>Update if statement to generalize as a factory</p>
</div>
<dl class="function">
<dt id="despasito.thermodynamics.calc.Pdiff">
<code class="sig-prename descclassname">despasito.thermodynamics.calc.</code><code class="sig-name descname">Pdiff</code><span class="sig-paren">(</span><em class="sig-param">rho</em>, <em class="sig-param">Pset</em>, <em class="sig-param">T</em>, <em class="sig-param">xi</em>, <em class="sig-param">eos</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/despasito/thermodynamics/calc.html#Pdiff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#despasito.thermodynamics.calc.Pdiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate difference between set point pressure and computed pressure for a given density</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>rho</strong><span class="classifier">float</span></dt><dd><p>Density of system [mol/<span class="math notranslate nohighlight">\(m^3\)</span>]</p>
</dd>
<dt><strong>Pset</strong><span class="classifier">float</span></dt><dd><p>Guess in pressure of the system [Pa]</p>
</dd>
<dt><strong>T</strong><span class="classifier">float</span></dt><dd><p>Temperature of the system [K]</p>
</dd>
<dt><strong>xi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Mole fraction of each component, sum(xi) should equal 1.0</p>
</dd>
<dt><strong>eos</strong><span class="classifier">obj</span></dt><dd><p>An instance of the defined EOS class to be used in thermodynamic computations.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>Pdiff</strong><span class="classifier">float</span></dt><dd><p>Difference in set pressure and predicted pressure given system conditions.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="despasito.thermodynamics.calc.PvsRho">
<code class="sig-prename descclassname">despasito.thermodynamics.calc.</code><code class="sig-name descname">PvsRho</code><span class="sig-paren">(</span><em class="sig-param">T</em>, <em class="sig-param">xi</em>, <em class="sig-param">eos</em>, <em class="sig-param">minrhofrac=2e-06</em>, <em class="sig-param">rhoinc=5.0</em>, <em class="sig-param">vspacemax=0.0001</em>, <em class="sig-param">maxpack=0.65</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/despasito/thermodynamics/calc.html#PvsRho"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#despasito.thermodynamics.calc.PvsRho" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Mie parameters of a mixture from the mixed critical properties of the pure components. 
From: Mejia, A., C. Herdes, E. Muller. Ind. Eng. Chem. Res. 2014, 53, 4131-4141</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>T</strong><span class="classifier">float</span></dt><dd><p>Temperature of the system [K]</p>
</dd>
<dt><strong>xi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Mole fraction of each component, sum(xi) should equal 1.0</p>
</dd>
<dt><strong>eos</strong><span class="classifier">obj</span></dt><dd><p>An instance of the defined EOS class to be used in thermodynamic computations.</p>
</dd>
<dt><strong>minrhofrac</strong><span class="classifier">float, Optional, default: (1.0/500000.0)</span></dt><dd><p>Fraction of the maximum density used to calculate, and is equal to, the minimum density of the density array. The minimum density is the reciprocal of the maximum specific volume used to calculate the roots. Passed from inputs to through the dictionary rhodict.</p>
</dd>
<dt><strong>rhoinc</strong><span class="classifier">float, Optional, default: 5.0</span></dt><dd><p>The increment between density values in the density array. Passed from inputs to through the dictionary rhodict.</p>
</dd>
<dt><strong>vspacemax</strong><span class="classifier">float, Optional, default: 1.0E-4</span></dt><dd><p>Maximum increment between specific volume array values. After conversion from density to specific volume, the increment values are compared to this value. Passed from inputs to through the dictionary rhodict.</p>
</dd>
<dt><strong>maxpack</strong><span class="classifier">float, Optional, default: 0.65</span></dt><dd><p>Maximum packing fraction. Passed from inputs to through the dictionary rhodict.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>vlist</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Specific volume array. Length depends on values in rhodict [<span class="math notranslate nohighlight">\(m^3\)</span>/mol]</p>
</dd>
<dt><strong>Plist</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Pressure associated with specific volume of system with given temperature and composition [Pa]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="despasito.thermodynamics.calc.PvsV_plot">
<code class="sig-prename descclassname">despasito.thermodynamics.calc.</code><code class="sig-name descname">PvsV_plot</code><span class="sig-paren">(</span><em class="sig-param">vlist</em>, <em class="sig-param">Plist</em>, <em class="sig-param">Pvspline</em>, <em class="sig-param">markers=[]</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/despasito/thermodynamics/calc.html#PvsV_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#despasito.thermodynamics.calc.PvsV_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot pressure vs. specific volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>vlist</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Specific volume array. Length depends on values in rhodict [<span class="math notranslate nohighlight">\(m^3\)</span>/mol]</p>
</dd>
<dt><strong>Plist</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Pressure associated with specific volume of system with given temperature and composition [Pa]</p>
</dd>
<dt><strong>Pvspline</strong><span class="classifier">obj</span></dt><dd><p>Function object of pressure vs. specific volume</p>
</dd>
<dt><strong>markers</strong><span class="classifier">list, Optional, default: []</span></dt><dd><p>List of plot markers used in plot</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="despasito.thermodynamics.calc.PvsV_spline">
<code class="sig-prename descclassname">despasito.thermodynamics.calc.</code><code class="sig-name descname">PvsV_spline</code><span class="sig-paren">(</span><em class="sig-param">vlist</em>, <em class="sig-param">Plist</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/despasito/thermodynamics/calc.html#PvsV_spline"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#despasito.thermodynamics.calc.PvsV_spline" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit arrays of specific volume and pressure values to a cubic Univariate Spline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>vlist</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Specific volume array. Length depends on values in rhodict [<span class="math notranslate nohighlight">\(m^3\)</span>/mol]</p>
</dd>
<dt><strong>Plist</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Pressure associated with specific volume of system with given temperature and composition [Pa]</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>Pvspline</strong><span class="classifier">obj</span></dt><dd><p>Function object of pressure vs. specific volume</p>
</dd>
<dt><strong>roots</strong><span class="classifier">list</span></dt><dd><p>List of specific volume roots. Subtract a system pressure from the output of Pvsrho to find density of vapor and/or liquid densities.</p>
</dd>
<dt><strong>extrema</strong><span class="classifier">list</span></dt><dd><p>List of specific volume values corresponding to local minima and maxima.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="despasito.thermodynamics.calc.calc_CC_Pguess">
<code class="sig-prename descclassname">despasito.thermodynamics.calc.</code><code class="sig-name descname">calc_CC_Pguess</code><span class="sig-paren">(</span><em class="sig-param">xilist</em>, <em class="sig-param">Tlist</em>, <em class="sig-param">CriticalProp</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/despasito/thermodynamics/calc.html#calc_CC_Pguess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#despasito.thermodynamics.calc.calc_CC_Pguess" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Mie parameters of a mixture from the mixed critical properties of the pure components. 
From: Mejia, A., C. Herdes, E. Muller. Ind. Eng. Chem. Res. 2014, 53, 4131-4141</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>xilist</strong><span class="classifier">list[list[xi]]</span></dt><dd><p>List of different Mole fractions of each component, sum(xi) should equal 1.0 for each set. Each set of components corresponds to a temperature in Tlist.</p>
</dd>
<dt><strong>Tlist</strong><span class="classifier">list[float]</span></dt><dd><p>Temperature of the system corresponding to composition in xilist [K]</p>
</dd>
<dt><strong>CriticalProp</strong><span class="classifier">list[list]</span></dt><dd><p>List of critical properties <span class="math notranslate nohighlight">\(T_C\)</span>, <span class="math notranslate nohighlight">\(P_C\)</span>, <span class="math notranslate nohighlight">\(\omega\)</span>, <span class="math notranslate nohighlight">\(\rho_{0.7}\)</span>, <span class="math notranslate nohighlight">\(Z_C\)</span>, <span class="math notranslate nohighlight">\(V_C\)</span>, and molecular weight, where each of these properties is a list of values for each bead.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>Psatm</strong><span class="classifier">list[float]</span></dt><dd><p>A list of guesses in pressure based on critical properties, of the same length as xilist and Tlist [Pa]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="despasito.thermodynamics.calc.calc_PT_phase">
<code class="sig-prename descclassname">despasito.thermodynamics.calc.</code><code class="sig-name descname">calc_PT_phase</code><span class="sig-paren">(</span><em class="sig-param">xi</em>, <em class="sig-param">T</em>, <em class="sig-param">eos</em>, <em class="sig-param">rhodict={}</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/despasito/thermodynamics/calc.html#calc_PT_phase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#despasito.thermodynamics.calc.calc_PT_phase" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Not Complete</strong>
Calculate the PT phase diagram given liquid mole fraction and temperature</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>xi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Liquid mole fraction of each component, sum(xi) should equal 1.0</p>
</dd>
<dt><strong>T</strong><span class="classifier">float</span></dt><dd><p>Temperature of the system [K]</p>
</dd>
<dt><strong>eos</strong><span class="classifier">obj</span></dt><dd><p>An instance of the defined EOS class to be used in thermodynamic computations.</p>
</dd>
<dt><strong>rhodict</strong><span class="classifier">dict, Optional, default: {}</span></dt><dd><p>Dictionary of options used in calculating pressure vs. mole</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>P</strong><span class="classifier">float</span></dt><dd><p>Pressure of the system [Pa]</p>
</dd>
<dt><strong>yi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Mole fraction of each component, sum(yi) should equal 1.0</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="despasito.thermodynamics.calc.calc_Prange_xi">
<code class="sig-prename descclassname">despasito.thermodynamics.calc.</code><code class="sig-name descname">calc_Prange_xi</code><span class="sig-paren">(</span><em class="sig-param">T</em>, <em class="sig-param">xi</em>, <em class="sig-param">yi</em>, <em class="sig-param">eos</em>, <em class="sig-param">rhodict={}</em>, <em class="sig-param">Pmin=1000</em>, <em class="sig-param">zi_opts={}</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/despasito/thermodynamics/calc.html#calc_Prange_xi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#despasito.thermodynamics.calc.calc_Prange_xi" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain min and max pressure values, where the liquid mole fraction is set and the objective function at each of those values is of opposite sign.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>T</strong><span class="classifier">float</span></dt><dd><p>Temperature of the system [K]</p>
</dd>
<dt><strong>xi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Liquid mole fraction of each component, sum(xi) should equal 1.0</p>
</dd>
<dt><strong>yi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Vapor mole fraction of each component, sum(xi) should equal 1.0</p>
</dd>
<dt><strong>eos</strong><span class="classifier">obj</span></dt><dd><p>An instance of the defined EOS class to be used in thermodynamic computations.</p>
</dd>
<dt><strong>rhodict</strong><span class="classifier">dict, Optional, default: {}</span></dt><dd><p>Dictionary of options used in calculating pressure vs. mole</p>
</dd>
<dt><strong>Pmin</strong><span class="classifier">float, Optional, default: 1000.0</span></dt><dd><p>Minimum pressure in pressure range that restricts searched space.</p>
</dd>
<dt><strong>zi_opts</strong><span class="classifier">dict, Optional, default: {}</span></dt><dd><p>Options used to solve the inner loop in the solving algorithm</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>Prange</strong><span class="classifier">list</span></dt><dd><p>List of min and max pressure range</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="despasito.thermodynamics.calc.calc_Prange_yi">
<code class="sig-prename descclassname">despasito.thermodynamics.calc.</code><code class="sig-name descname">calc_Prange_yi</code><span class="sig-paren">(</span><em class="sig-param">T</em>, <em class="sig-param">xi</em>, <em class="sig-param">yi</em>, <em class="sig-param">eos</em>, <em class="sig-param">rhodict={}</em>, <em class="sig-param">Pmin=1000</em>, <em class="sig-param">zi_opts={}</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/despasito/thermodynamics/calc.html#calc_Prange_yi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#despasito.thermodynamics.calc.calc_Prange_yi" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain min and max pressure values, where the vapor mole fraction is set and the objective function at each of those values is of opposite sign.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>T</strong><span class="classifier">float</span></dt><dd><p>Temperature of the system [K]</p>
</dd>
<dt><strong>xi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Liquid mole fraction of each component, sum(xi) should equal 1.0</p>
</dd>
<dt><strong>yi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Vapor mole fraction of each component, sum(xi) should equal 1.0</p>
</dd>
<dt><strong>eos</strong><span class="classifier">obj</span></dt><dd><p>An instance of the defined EOS class to be used in thermodynamic computations.</p>
</dd>
<dt><strong>rhodict</strong><span class="classifier">dict, Optional, default: {}</span></dt><dd><p>Dictionary of options used in calculating pressure vs. mole</p>
</dd>
<dt><strong>Pmin</strong><span class="classifier">float, Optional, default: 1000.0</span></dt><dd><p>Minimum pressure in pressure range that restricts searched space.</p>
</dd>
<dt><strong>zi_opts</strong><span class="classifier">dict, Optional, default: {}</span></dt><dd><p>Options used to solve the inner loop in the solving algorithm</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>Prange</strong><span class="classifier">list</span></dt><dd><p>List of min and max pressure range</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="despasito.thermodynamics.calc.calc_Psat">
<code class="sig-prename descclassname">despasito.thermodynamics.calc.</code><code class="sig-name descname">calc_Psat</code><span class="sig-paren">(</span><em class="sig-param">T</em>, <em class="sig-param">xi</em>, <em class="sig-param">eos</em>, <em class="sig-param">rhodict={}</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/despasito/thermodynamics/calc.html#calc_Psat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#despasito.thermodynamics.calc.calc_Psat" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the saturated pressure, gas and liquid densities for a single component system given Temperature and Mie parameters
T: Saturated Temperature in Kelvin
minrhofrac: Fraction of maximum hard sphere packing fraction for gas density
rhoinc: spacing densities for rholist in mol/m^3. Smaller values will generate a more accurate curve at increasing computational cost
Returns Saturated Pressure in Pa, liquid denisty, and gas density in mol/m^3</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>T</strong><span class="classifier">float</span></dt><dd><p>Temperature of the system [K]</p>
</dd>
<dt><strong>xi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Mole fraction of each component, sum(xi) should equal 1.0</p>
</dd>
<dt><strong>eos</strong><span class="classifier">obj</span></dt><dd><p>An instance of the defined EOS class to be used in thermodynamic computations.</p>
</dd>
<dt><strong>rhodict</strong><span class="classifier">dict, Optional, default: {}</span></dt><dd><p>Dictionary of options used in calculating pressure vs. mole</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>Psat</strong><span class="classifier">float</span></dt><dd><p>Saturation pressure given system information [Pa]</p>
</dd>
<dt><strong>rhov</strong><span class="classifier">float</span></dt><dd><p>Density of vapor at saturation pressure [mol/<span class="math notranslate nohighlight">\(m^3\)</span>]</p>
</dd>
<dt><strong>rhol</strong><span class="classifier">float</span></dt><dd><p>Density of liquid at saturation pressure [mol/<span class="math notranslate nohighlight">\(m^3\)</span>]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="despasito.thermodynamics.calc.calc_dadT">
<code class="sig-prename descclassname">despasito.thermodynamics.calc.</code><code class="sig-name descname">calc_dadT</code><span class="sig-paren">(</span><em class="sig-param">rho</em>, <em class="sig-param">T</em>, <em class="sig-param">xi</em>, <em class="sig-param">eos</em>, <em class="sig-param">rhodict={}</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/despasito/thermodynamics/calc.html#calc_dadT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#despasito.thermodynamics.calc.calc_dadT" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the derivative of the Helmholtz energy with respect to temperature, <span class="math notranslate nohighlight">\(\frac{dA}{dT}\)</span>, give a list of density values and system conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>rho</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Density array. Length depends on values in rhodict [mol/<span class="math notranslate nohighlight">\(m^3\)</span>]</p>
</dd>
<dt><strong>T</strong><span class="classifier">float</span></dt><dd><p>Temperature of the system [K]</p>
</dd>
<dt><strong>xi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Liquid mole fraction of each component, sum(xi) should equal 1.0</p>
</dd>
<dt><strong>eos</strong><span class="classifier">obj</span></dt><dd><p>An instance of the defined EOS class to be used in thermodynamic computations.</p>
</dd>
<dt><strong>rhodict</strong><span class="classifier">dict, Optional, default: {}</span></dt><dd><p>Dictionary of options used in calculating pressure vs. mole</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>dadT</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Array of derivative values of Helmholtz energy with respect to temperature</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="despasito.thermodynamics.calc.calc_phil">
<code class="sig-prename descclassname">despasito.thermodynamics.calc.</code><code class="sig-name descname">calc_phil</code><span class="sig-paren">(</span><em class="sig-param">P</em>, <em class="sig-param">T</em>, <em class="sig-param">xi</em>, <em class="sig-param">eos</em>, <em class="sig-param">rhodict={}</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/despasito/thermodynamics/calc.html#calc_phil"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#despasito.thermodynamics.calc.calc_phil" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes liquid fugacity coefficient under system conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>P</strong><span class="classifier">float</span></dt><dd><p>Pressure of the system [Pa]</p>
</dd>
<dt><strong>T</strong><span class="classifier">float</span></dt><dd><p>Temperature of the system [K]</p>
</dd>
<dt><strong>xi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Mole fraction of each component, sum(xi) should equal 1.0</p>
</dd>
<dt><strong>eos</strong><span class="classifier">obj</span></dt><dd><p>An instance of the defined EOS class to be used in thermodynamic computations.</p>
</dd>
<dt><strong>rhodict</strong><span class="classifier">dict, Optional, default: {}</span></dt><dd><p>Dictionary of options used in calculating pressure vs. mole</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>phil</strong><span class="classifier">float</span></dt><dd><p>Fugacity coefficient of liquid at system pressure</p>
</dd>
<dt><strong>rhol</strong><span class="classifier">float</span></dt><dd><p>Density of liquid at system pressure [mol/<span class="math notranslate nohighlight">\(m^3\)</span>]</p>
</dd>
<dt><strong>flag</strong><span class="classifier">int</span></dt><dd><p>Flag identifying the fluid type. A value of 0 is vapor, 1 is liquid, 2 mean a critical fluid, 3 means that neither is true.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="despasito.thermodynamics.calc.calc_phiv">
<code class="sig-prename descclassname">despasito.thermodynamics.calc.</code><code class="sig-name descname">calc_phiv</code><span class="sig-paren">(</span><em class="sig-param">P</em>, <em class="sig-param">T</em>, <em class="sig-param">yi</em>, <em class="sig-param">eos</em>, <em class="sig-param">rhodict={}</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/despasito/thermodynamics/calc.html#calc_phiv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#despasito.thermodynamics.calc.calc_phiv" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes vapor fugacity coefficient under system conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>P</strong><span class="classifier">float</span></dt><dd><p>Pressure of the system [Pa]</p>
</dd>
<dt><strong>T</strong><span class="classifier">float</span></dt><dd><p>Temperature of the system [K]</p>
</dd>
<dt><strong>yi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Mole fraction of each component, sum(xi) should equal 1.0</p>
</dd>
<dt><strong>eos</strong><span class="classifier">obj</span></dt><dd><p>An instance of the defined EOS class to be used in thermodynamic computations.</p>
</dd>
<dt><strong>rhodict</strong><span class="classifier">dict, Optional, default: {}</span></dt><dd><p>Dictionary of options used in calculating pressure vs. mole</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>phiv</strong><span class="classifier">float</span></dt><dd><p>Fugacity coefficient of vapor at system pressure</p>
</dd>
<dt><strong>rhov</strong><span class="classifier">float</span></dt><dd><p>Density of vapor at system pressure [mol/<span class="math notranslate nohighlight">\(m^3\)</span>]</p>
</dd>
<dt><strong>flag</strong><span class="classifier">int</span></dt><dd><p>Flag identifying the fluid type. A value of 0 is vapor, 1 is liquid, 2 mean a critical fluid, 3 means that neither is true, 4 means ideal gas is assumed</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="despasito.thermodynamics.calc.calc_rhol">
<code class="sig-prename descclassname">despasito.thermodynamics.calc.</code><code class="sig-name descname">calc_rhol</code><span class="sig-paren">(</span><em class="sig-param">P</em>, <em class="sig-param">T</em>, <em class="sig-param">xi</em>, <em class="sig-param">eos</em>, <em class="sig-param">rhodict={}</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/despasito/thermodynamics/calc.html#calc_rhol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#despasito.thermodynamics.calc.calc_rhol" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes liquid density under system conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>P</strong><span class="classifier">float</span></dt><dd><p>Pressure of the system [Pa]</p>
</dd>
<dt><strong>T</strong><span class="classifier">float</span></dt><dd><p>Temperature of the system [K]</p>
</dd>
<dt><strong>xi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Mole fraction of each component, sum(xi) should equal 1.0</p>
</dd>
<dt><strong>eos</strong><span class="classifier">obj</span></dt><dd><p>An instance of the defined EOS class to be used in thermodynamic computations.</p>
</dd>
<dt><strong>rhodict</strong><span class="classifier">dict, Optional, default: {}</span></dt><dd><p>Dictionary of options used in calculating pressure vs. mole</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>rhol</strong><span class="classifier">float</span></dt><dd><p>Density of liquid at system pressure [mol/<span class="math notranslate nohighlight">\(m^3\)</span>]</p>
</dd>
<dt><strong>flag</strong><span class="classifier">int</span></dt><dd><p>A value of 0 is vapor, 1 is liquid, 2 mean a critical fluid, 3 means that neither is true</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="despasito.thermodynamics.calc.calc_rhov">
<code class="sig-prename descclassname">despasito.thermodynamics.calc.</code><code class="sig-name descname">calc_rhov</code><span class="sig-paren">(</span><em class="sig-param">P</em>, <em class="sig-param">T</em>, <em class="sig-param">xi</em>, <em class="sig-param">eos</em>, <em class="sig-param">rhodict={}</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/despasito/thermodynamics/calc.html#calc_rhov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#despasito.thermodynamics.calc.calc_rhov" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes vapor density under system conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>P</strong><span class="classifier">float</span></dt><dd><p>Pressure of the system [Pa]</p>
</dd>
<dt><strong>T</strong><span class="classifier">float</span></dt><dd><p>Temperature of the system [K]</p>
</dd>
<dt><strong>xi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Mole fraction of each component, sum(xi) should equal 1.0</p>
</dd>
<dt><strong>eos</strong><span class="classifier">obj</span></dt><dd><p>An instance of the defined EOS class to be used in thermodynamic computations.</p>
</dd>
<dt><strong>rhodict</strong><span class="classifier">dict, Optional, default: {}</span></dt><dd><p>Dictionary of options used in calculating pressure vs. mole</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>rhov</strong><span class="classifier">float</span></dt><dd><p>Density of vapor at system pressure [mol/<span class="math notranslate nohighlight">\(m^3\)</span>]</p>
</dd>
<dt><strong>flag</strong><span class="classifier">int</span></dt><dd><p>A value of 0 is vapor, 1 is liquid, 2 mean a critical fluid, 3 means that neither is true, 4 means we should assume ideal gas</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="despasito.thermodynamics.calc.calc_xT_phase">
<code class="sig-prename descclassname">despasito.thermodynamics.calc.</code><code class="sig-name descname">calc_xT_phase</code><span class="sig-paren">(</span><em class="sig-param">xi</em>, <em class="sig-param">T</em>, <em class="sig-param">eos</em>, <em class="sig-param">rhodict={}</em>, <em class="sig-param">zi_opts={}</em>, <em class="sig-param">Pguess=-1</em>, <em class="sig-param">meth='hybr'</em>, <em class="sig-param">pressure_opts={}</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/despasito/thermodynamics/calc.html#calc_xT_phase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#despasito.thermodynamics.calc.calc_xT_phase" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate bubble point mole fraction and pressure given system liquid mole fraction and temperature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>xi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Liquid mole fraction of each component, sum(xi) should equal 1.0</p>
</dd>
<dt><strong>T</strong><span class="classifier">float</span></dt><dd><p>Temperature of the system [K]</p>
</dd>
<dt><strong>eos</strong><span class="classifier">obj</span></dt><dd><p>An instance of the defined EOS class to be used in thermodynamic computations.</p>
</dd>
<dt><strong>rhodict</strong><span class="classifier">dict, Optional, default: {}</span></dt><dd><p>Dictionary of options used in calculating pressure vs. mole</p>
</dd>
<dt><strong>zi_opts</strong><span class="classifier">dict, Optional, default: {}</span></dt><dd><p>Options used to solve the inner loop in the solving algorithm</p>
</dd>
<dt><strong>Pguess</strong><span class="classifier">float, Optional, default: -1</span></dt><dd><p>Guess the system pressure at the dew point. A negative value will force an estimation based on the saturation pressure of each component.</p>
</dd>
<dt><strong>meth</strong><span class="classifier">str, Optional, default: “broyden1”</span></dt><dd><p>Choose the method used to solve the dew point calculation</p>
</dd>
<dt><strong>pressure_opts</strong><span class="classifier">dict, Optional, default: {}</span></dt><dd><p>Options used in the given method, “meth”, to solve the outer loop in the solving algorithm</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>P</strong><span class="classifier">float</span></dt><dd><p>Pressure of the system [Pa]</p>
</dd>
<dt><strong>yi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Mole fraction of each component, sum(yi) should equal 1.0</p>
</dd>
<dt><strong>flagv</strong><span class="classifier">int</span></dt><dd><p>Flag identifying the fluid type for the vapor mole fractions, expected is vapor or 0. A value of 0 is vapor, 1 is liquid, 2 mean a critical fluid, 3 means that neither is true, 4 means ideal gas is assumed</p>
</dd>
<dt><strong>flagl</strong><span class="classifier">int</span></dt><dd><p>Flag identifying the fluid type for the liquid mole fractions, expected is liquid, 1. A value of 0 is vapor, 1 is liquid, 2 mean a critical fluid, 3 means that neither is true</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="despasito.thermodynamics.calc.calc_yT_phase">
<code class="sig-prename descclassname">despasito.thermodynamics.calc.</code><code class="sig-name descname">calc_yT_phase</code><span class="sig-paren">(</span><em class="sig-param">yi</em>, <em class="sig-param">T</em>, <em class="sig-param">eos</em>, <em class="sig-param">rhodict={}</em>, <em class="sig-param">zi_opts={}</em>, <em class="sig-param">Pguess=-1</em>, <em class="sig-param">meth='hybr'</em>, <em class="sig-param">pressure_opts={}</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/despasito/thermodynamics/calc.html#calc_yT_phase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#despasito.thermodynamics.calc.calc_yT_phase" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate dew point mole fraction and pressure given system vapor mole fraction and temperature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>yi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Vapor mole fraction of each component, sum(yi) should equal 1.0</p>
</dd>
<dt><strong>T</strong><span class="classifier">float</span></dt><dd><p>Temperature of the system [K]</p>
</dd>
<dt><strong>eos</strong><span class="classifier">obj</span></dt><dd><p>An instance of the defined EOS class to be used in thermodynamic computations.</p>
</dd>
<dt><strong>rhodict</strong><span class="classifier">dict, Optional, default: {}</span></dt><dd><p>Dictionary of options used in calculating pressure vs. mole</p>
</dd>
<dt><strong>zi_opts</strong><span class="classifier">dict, Optional, default: {}</span></dt><dd><p>Options used to solve the inner loop in the solving algorithm</p>
</dd>
<dt><strong>Pguess</strong><span class="classifier">float, Optional, default: -1</span></dt><dd><p>Guess the system pressure at the dew point. A negative value will force an estimation based on the saturation pressure of each component.</p>
</dd>
<dt><strong>meth</strong><span class="classifier">str, Optional, default: “broyden1”</span></dt><dd><p>Choose the method used to solve the dew point calculation</p>
</dd>
<dt><strong>pressure_opts</strong><span class="classifier">dict, Optional, default: {}</span></dt><dd><p>Options used in the given method, “meth”, to solve the outer loop in the solving algorithm</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>P</strong><span class="classifier">float</span></dt><dd><p>Pressure of the system [Pa]</p>
</dd>
<dt><strong>xi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Mole fraction of each component, sum(xi) should equal 1.0</p>
</dd>
<dt><strong>flagl</strong><span class="classifier">int</span></dt><dd><p>Flag identifying the fluid type for the liquid mole fractions, expected is liquid, 1. A value of 0 is vapor, 1 is liquid, 2 mean a critical fluid, 3 means that neither is true</p>
</dd>
<dt><strong>flagv</strong><span class="classifier">int</span></dt><dd><p>Flag identifying the fluid type for the vapor mole fractions, expected is vapor or 0. A value of 0 is vapor, 1 is liquid, 2 mean a critical fluid, 3 means that neither is true, 4 means ideal gas is assumed</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="despasito.thermodynamics.calc.eq_area">
<code class="sig-prename descclassname">despasito.thermodynamics.calc.</code><code class="sig-name descname">eq_area</code><span class="sig-paren">(</span><em class="sig-param">shift</em>, <em class="sig-param">Pv</em>, <em class="sig-param">vlist</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/despasito/thermodynamics/calc.html#eq_area"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#despasito.thermodynamics.calc.eq_area" title="Permalink to this definition">¶</a></dt>
<dd><p>Objective function used to calculate the saturation pressure.</p>
<p>Note: If the curve hasn’t decayed to 0 yet, estimate the remaining area as a triangle. This isn’t super accurate but we are just using the saturation pressure to get started.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>shift</strong><span class="classifier">float</span></dt><dd><p>Guess in Psat value used to translate the pressure vs. specific volume curve [Pa]</p>
</dd>
<dt><strong>Pv</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Pressure associated with specific volume of system with given temperature and composition [Pa]</p>
</dd>
<dt><strong>vlist</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Specific volume array. Length depends on values in rhodict [<span class="math notranslate nohighlight">\(m^3\)</span>/mol]</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>obj_value</strong><span class="classifier">float</span></dt><dd><p>Output of objective function, the addition of the positive area between first two roots, and negative area between second and third roots, quantity squared.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="despasito.thermodynamics.calc.find_new_yi">
<code class="sig-prename descclassname">despasito.thermodynamics.calc.</code><code class="sig-name descname">find_new_yi</code><span class="sig-paren">(</span><em class="sig-param">P</em>, <em class="sig-param">T</em>, <em class="sig-param">phil</em>, <em class="sig-param">xi</em>, <em class="sig-param">eos</em>, <em class="sig-param">rhodict={}</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/despasito/thermodynamics/calc.html#find_new_yi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#despasito.thermodynamics.calc.find_new_yi" title="Permalink to this definition">¶</a></dt>
<dd><p>Search vapor mole fraction combinations for a new estimate that produces a vapor density.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>P</strong><span class="classifier">float</span></dt><dd><p>Pressure of the system [Pa]</p>
</dd>
<dt><strong>T</strong><span class="classifier">float</span></dt><dd><p>Temperature of the system [K]</p>
</dd>
<dt><strong>phil</strong><span class="classifier">float</span></dt><dd><p>Fugacity coefficient of liquid at system pressure</p>
</dd>
<dt><strong>xi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Liquid mole fraction of each component, sum(xi) should equal 1.0</p>
</dd>
<dt><strong>eos</strong><span class="classifier">obj</span></dt><dd><p>An instance of the defined EOS class to be used in thermodynamic computations.</p>
</dd>
<dt><strong>rhodict</strong><span class="classifier">dict, Optional, default: {}</span></dt><dd><p>Dictionary of options used in calculating pressure vs. mole</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>yi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Vapor mole fraction of each component, sum(yi) should equal 1.0</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="despasito.thermodynamics.calc.obj_yi">
<code class="sig-prename descclassname">despasito.thermodynamics.calc.</code><code class="sig-name descname">obj_yi</code><span class="sig-paren">(</span><em class="sig-param">yi</em>, <em class="sig-param">P</em>, <em class="sig-param">T</em>, <em class="sig-param">phil</em>, <em class="sig-param">xi</em>, <em class="sig-param">eos</em>, <em class="sig-param">rhodict={}</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/despasito/thermodynamics/calc.html#obj_yi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#despasito.thermodynamics.calc.obj_yi" title="Permalink to this definition">¶</a></dt>
<dd><p>Objective function for solving for stable vapor mole fraction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>yi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Vapor mole fraction of each component, sum(yi) should equal 1.0</p>
</dd>
<dt><strong>P</strong><span class="classifier">float</span></dt><dd><p>Pressure of the system [Pa]</p>
</dd>
<dt><strong>T</strong><span class="classifier">float</span></dt><dd><p>Temperature of the system [K]</p>
</dd>
<dt><strong>phil</strong><span class="classifier">float</span></dt><dd><p>Fugacity coefficient of liquid at system pressure</p>
</dd>
<dt><strong>xi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Liquid mole fraction of each component, sum(xi) should equal 1.0</p>
</dd>
<dt><strong>eos</strong><span class="classifier">obj</span></dt><dd><p>An instance of the defined EOS class to be used in thermodynamic computations.</p>
</dd>
<dt><strong>rhodict</strong><span class="classifier">dict, Optional, default: {}</span></dt><dd><p>Dictionary of options used in calculating pressure vs. mole</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>obj</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Objective function for solving for vapor mole fractions</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="despasito.thermodynamics.calc.setPsat">
<code class="sig-prename descclassname">despasito.thermodynamics.calc.</code><code class="sig-name descname">setPsat</code><span class="sig-paren">(</span><em class="sig-param">ind</em>, <em class="sig-param">eos</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/despasito/thermodynamics/calc.html#setPsat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#despasito.thermodynamics.calc.setPsat" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate dummy value for component saturation pressure if it is above its critical point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ind</strong><span class="classifier">int</span></dt><dd><p>Index of bead that is above critical point</p>
</dd>
<dt><strong>eos</strong><span class="classifier">obj</span></dt><dd><p>An instance of the defined EOS class to be used in thermodynamic computations.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>Psat</strong><span class="classifier">float</span></dt><dd><p>Dummy value of saturation pressure [Pa]</p>
</dd>
<dt><strong>NaNbead</strong><span class="classifier">str</span></dt><dd><p>Bead name of the component that is above it’s critical point</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="despasito.thermodynamics.calc.solve_P_xiT">
<code class="sig-prename descclassname">despasito.thermodynamics.calc.</code><code class="sig-name descname">solve_P_xiT</code><span class="sig-paren">(</span><em class="sig-param">P</em>, <em class="sig-param">xi</em>, <em class="sig-param">T</em>, <em class="sig-param">eos</em>, <em class="sig-param">rhodict</em>, <em class="sig-param">zi_opts={}</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/despasito/thermodynamics/calc.html#solve_P_xiT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#despasito.thermodynamics.calc.solve_P_xiT" title="Permalink to this definition">¶</a></dt>
<dd><p>Objective function used to search pressure values and solve outer loop of P bubble point calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>P</strong><span class="classifier">float</span></dt><dd><p>Guess in pressure of the system [Pa]</p>
</dd>
<dt><strong>xi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Liquid mole fraction of each component, sum(xi) should equal 1.0</p>
</dd>
<dt><strong>T</strong><span class="classifier">float</span></dt><dd><p>Temperature of the system [K]</p>
</dd>
<dt><strong>eos</strong><span class="classifier">obj</span></dt><dd><p>An instance of the defined EOS class to be used in thermodynamic computations.</p>
</dd>
<dt><strong>rhodict</strong><span class="classifier">dict, Optional, default: {}</span></dt><dd><p>Dictionary of options used in calculating pressure vs. mole</p>
</dd>
<dt><strong>zi_opts</strong><span class="classifier">dict, Optional, default: {}</span></dt><dd><p>Options used to solve the inner loop in the solving algorithm</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>obj_value</strong><span class="classifier">float</span></dt><dd><p><span class="math notranslate nohighlight">\(\sum\frac{x_{i}\{phi_l}{\phi_v}-1\)</span></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="despasito.thermodynamics.calc.solve_P_yiT">
<code class="sig-prename descclassname">despasito.thermodynamics.calc.</code><code class="sig-name descname">solve_P_yiT</code><span class="sig-paren">(</span><em class="sig-param">P</em>, <em class="sig-param">yi</em>, <em class="sig-param">T</em>, <em class="sig-param">eos</em>, <em class="sig-param">rhodict</em>, <em class="sig-param">zi_opts={}</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/despasito/thermodynamics/calc.html#solve_P_yiT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#despasito.thermodynamics.calc.solve_P_yiT" title="Permalink to this definition">¶</a></dt>
<dd><p>Objective function used to search pressure values and solve outer loop of P dew point calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>P</strong><span class="classifier">float</span></dt><dd><p>Guess in pressure of the system [Pa]</p>
</dd>
<dt><strong>yi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Vapor mole fraction of each component, sum(yi) should equal 1.0</p>
</dd>
<dt><strong>T</strong><span class="classifier">float</span></dt><dd><p>Temperature of the system [K]</p>
</dd>
<dt><strong>eos</strong><span class="classifier">obj</span></dt><dd><p>An instance of the defined EOS class to be used in thermodynamic computations.</p>
</dd>
<dt><strong>rhodict</strong><span class="classifier">dict, Optional, default: {}</span></dt><dd><p>Dictionary of options used in calculating pressure vs. mole</p>
</dd>
<dt><strong>zi_opts</strong><span class="classifier">dict, Optional, default: {}</span></dt><dd><p>Options used to solve the inner loop in the solving algorithm</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>obj_value</strong><span class="classifier">list</span></dt><dd><p><span class="math notranslate nohighlight">\(\sum\frac{y_{i}\{phi_v}{\phi_l}-1\)</span></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="despasito.thermodynamics.calc.solve_xi_root">
<code class="sig-prename descclassname">despasito.thermodynamics.calc.</code><code class="sig-name descname">solve_xi_root</code><span class="sig-paren">(</span><em class="sig-param">xi0</em>, <em class="sig-param">yi</em>, <em class="sig-param">phiv</em>, <em class="sig-param">P</em>, <em class="sig-param">T</em>, <em class="sig-param">eos</em>, <em class="sig-param">rhodict</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/despasito/thermodynamics/calc.html#solve_xi_root"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#despasito.thermodynamics.calc.solve_xi_root" title="Permalink to this definition">¶</a></dt>
<dd><p>Objective function used to search liquid mole fraction and solve inner loop of dew point calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>xi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Guess in liquid mole fraction of each component, sum(xi) should equal 1.0</p>
</dd>
<dt><strong>yi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Vapor mole fraction of each component, sum(yi) should equal 1.0</p>
</dd>
<dt><strong>phiv</strong><span class="classifier">float</span></dt><dd><p>Fugacity coefficient of vapor at system pressure</p>
</dd>
<dt><strong>P</strong><span class="classifier">float</span></dt><dd><p>Pressure of the system [Pa]</p>
</dd>
<dt><strong>T</strong><span class="classifier">float</span></dt><dd><p>Temperature of the system [K]</p>
</dd>
<dt><strong>eos</strong><span class="classifier">obj</span></dt><dd><p>An instance of the defined EOS class to be used in thermodynamic computations.</p>
</dd>
<dt><strong>rhodict</strong><span class="classifier">dict, Optional, default: {}</span></dt><dd><p>Dictionary of options used in calculating pressure vs. mole</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>obj_value</strong><span class="classifier">list</span></dt><dd><p>List of percent change between guess that is input and the updated version from recalculating with fugacity coefficients.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="despasito.thermodynamics.calc.solve_xi_yiT">
<code class="sig-prename descclassname">despasito.thermodynamics.calc.</code><code class="sig-name descname">solve_xi_yiT</code><span class="sig-paren">(</span><em class="sig-param">xi</em>, <em class="sig-param">yi</em>, <em class="sig-param">phiv</em>, <em class="sig-param">P</em>, <em class="sig-param">T</em>, <em class="sig-param">eos</em>, <em class="sig-param">rhodict={}</em>, <em class="sig-param">maxiter=20</em>, <em class="sig-param">tol=1e-06</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/despasito/thermodynamics/calc.html#solve_xi_yiT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#despasito.thermodynamics.calc.solve_xi_yiT" title="Permalink to this definition">¶</a></dt>
<dd><p>Find liquid mole fraction given pressure, vapor mole fraction, and temperature. Objective function is the sum of the predicted “mole numbers” predicted by the computed fugacity coefficients. Note that by “mole number” we mean that the prediction will only sum to 1 when the correct pressure is chosen in the outer loop. In this inner loop, we seek to find a mole fraction that is converged to reproduce itself in a prediction. If it hasn’t, the new “mole numbers” are normalized into mole fractions and used as the next guess.
In the case that a guess doesn’t produce a liquid or critical fluid, we use another function to produce a new guess.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>xi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Guess in liquid mole fraction of each component, sum(xi) should equal 1.0</p>
</dd>
<dt><strong>yi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Vapor mole fraction of each component, sum(xi) should equal 1.0</p>
</dd>
<dt><strong>phiv</strong><span class="classifier">float</span></dt><dd><p>Fugacity coefficient of liquid at system pressure</p>
</dd>
<dt><strong>P</strong><span class="classifier">float</span></dt><dd><p>Pressure of the system [Pa]</p>
</dd>
<dt><strong>T</strong><span class="classifier">float</span></dt><dd><p>Temperature of the system [K]</p>
</dd>
<dt><strong>eos</strong><span class="classifier">obj</span></dt><dd><p>An instance of the defined EOS class to be used in thermodynamic computations.</p>
</dd>
<dt><strong>rhodict</strong><span class="classifier">dict, Optional, default: {}</span></dt><dd><p>Dictionary of options used in calculating pressure vs. mole</p>
</dd>
<dt><strong>maxiter</strong><span class="classifier">int, Optional, default: 20</span></dt><dd><p>Maximum number of iteration for both the outer pressure and inner vapor mole fraction loops</p>
</dd>
<dt><strong>tol</strong><span class="classifier">float, Optional, default: 1e-6</span></dt><dd><p>Tolerance in sum of predicted xi “mole numbers”</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>xi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Liquid mole fraction of each component, sum(xi) should equal 1.0</p>
</dd>
<dt><strong>phil</strong><span class="classifier">float</span></dt><dd><p>Fugacity coefficient of liquid at system pressure</p>
</dd>
<dt><strong>flag</strong><span class="classifier">int</span></dt><dd><p>Flag identifying the fluid type. A value of 0 is vapor, 1 is liquid, 2 mean a critical fluid, 3 means that neither is true</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="despasito.thermodynamics.calc.solve_yi_root">
<code class="sig-prename descclassname">despasito.thermodynamics.calc.</code><code class="sig-name descname">solve_yi_root</code><span class="sig-paren">(</span><em class="sig-param">yi0</em>, <em class="sig-param">xi</em>, <em class="sig-param">phil</em>, <em class="sig-param">P</em>, <em class="sig-param">T</em>, <em class="sig-param">eos</em>, <em class="sig-param">rhodict={}</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/despasito/thermodynamics/calc.html#solve_yi_root"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#despasito.thermodynamics.calc.solve_yi_root" title="Permalink to this definition">¶</a></dt>
<dd><p>Objective function used to search vapor mole fraction and solve inner loop of bubble point calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>yi0</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Guess in vapor mole fraction of each component, sum(yi) should equal 1.0</p>
</dd>
<dt><strong>xi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Liquid mole fraction of each component, sum(xi) should equal 1.0</p>
</dd>
<dt><strong>phil</strong><span class="classifier">float</span></dt><dd><p>Fugacity coefficient of liquid at system pressure</p>
</dd>
<dt><strong>P</strong><span class="classifier">float</span></dt><dd><p>Pressure of the system [Pa]</p>
</dd>
<dt><strong>T</strong><span class="classifier">float</span></dt><dd><p>Temperature of the system [K]</p>
</dd>
<dt><strong>eos</strong><span class="classifier">obj</span></dt><dd><p>An instance of the defined EOS class to be used in thermodynamic computations.</p>
</dd>
<dt><strong>rhodict</strong><span class="classifier">dict, Optional, default: {}</span></dt><dd><p>Dictionary of options used in calculating pressure vs. mole</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>obj_value</strong><span class="classifier">list</span></dt><dd><p>List of absolute change between guess that is input and the updated version from recalculating with fugacity coefficients.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="despasito.thermodynamics.calc.solve_yi_xiT">
<code class="sig-prename descclassname">despasito.thermodynamics.calc.</code><code class="sig-name descname">solve_yi_xiT</code><span class="sig-paren">(</span><em class="sig-param">yi</em>, <em class="sig-param">xi</em>, <em class="sig-param">phil</em>, <em class="sig-param">P</em>, <em class="sig-param">T</em>, <em class="sig-param">eos</em>, <em class="sig-param">rhodict={}</em>, <em class="sig-param">maxiter=30</em>, <em class="sig-param">tol=1e-06</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/despasito/thermodynamics/calc.html#solve_yi_xiT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#despasito.thermodynamics.calc.solve_yi_xiT" title="Permalink to this definition">¶</a></dt>
<dd><p>Find vapor mole fraction given pressure, liquid mole fraction, and temperature. Objective function is the sum of the predicted “mole numbers” predicted by the computed fugacity coefficients. Note that by “mole number” we mean that the prediction will only sum to 1 when the correct pressure is chosen in the outer loop. In this inner loop, we seek to find a mole fraction that is converged to reproduce itself in a prediction. If it hasn’t, the new “mole numbers” are normalized into mole fractions and used as the next guess.
In the case that a guess doesn’t produce a gas or critical fluid, we use another function to produce a new guess.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>yi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Guess in vapor mole fraction of each component, sum(xi) should equal 1.0</p>
</dd>
<dt><strong>xi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Liquid mole fraction of each component, sum(xi) should equal 1.0</p>
</dd>
<dt><strong>phil</strong><span class="classifier">float</span></dt><dd><p>Fugacity coefficient of liquid at system pressure</p>
</dd>
<dt><strong>P</strong><span class="classifier">float</span></dt><dd><p>Pressure of the system [Pa]</p>
</dd>
<dt><strong>T</strong><span class="classifier">float</span></dt><dd><p>Temperature of the system [K]</p>
</dd>
<dt><strong>eos</strong><span class="classifier">obj</span></dt><dd><p>An instance of the defined EOS class to be used in thermodynamic computations.</p>
</dd>
<dt><strong>rhodict</strong><span class="classifier">dict, Optional, default: {}</span></dt><dd><p>Dictionary of options used in calculating pressure vs. mole</p>
</dd>
<dt><strong>maxiter</strong><span class="classifier">int, Optional, default: 30</span></dt><dd><p>Maximum number of iteration for both the outer pressure and inner vapor mole fraction loops</p>
</dd>
<dt><strong>tol</strong><span class="classifier">float, Optional, default: 1e-6</span></dt><dd><p>Tolerance in sum of predicted yi “mole numbers”</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>yi</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>Vapor mole fraction of each component, sum(xi) should equal 1.0</p>
</dd>
<dt><strong>phiv</strong><span class="classifier">float</span></dt><dd><p>Fugacity coefficient of vapor at system pressure</p>
</dd>
<dt><strong>flag</strong><span class="classifier">int</span></dt><dd><p>Flag identifying the fluid type. A value of 0 is vapor, 1 is liquid, 2 mean a critical fluid, 3 means that neither is true, 4 means ideal gas is assumed</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../fitparams.html" class="btn btn-neutral float-right" title="Parametrization" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../thermo.html" class="btn btn-neutral float-left" title="Thermodynamic Calculations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Jennifer A Clark. Project structure based on the Computational Molecular Science Python Cookiecutter version 1.0

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>