

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>despasito.fit_parameters &mdash; DESPASITO  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> DESPASITO
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API Documentation</a></li>
</ul>
<p class="caption"><span class="caption-text">Modules:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../input_output.html">Input/Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../eos.html">Equations of State</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../thermo.html">Thermodynamic Calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../fitparams.html">Parametrization</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">DESPASITO</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>despasito.fit_parameters</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for despasito.fit_parameters</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Fit Parameters</span>
<span class="sd">--------------</span>

<span class="sd">This package uses functions from input_output, equations_of_state, and thermodynamics to fit parameters to experimental data.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">importlib</span> <span class="k">import</span> <span class="n">import_module</span>
<span class="kn">import</span> <span class="nn">scipy.optimize</span> <span class="k">as</span> <span class="nn">spo</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">fit_funcs</span> <span class="k">as</span> <span class="n">ff</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">data_classes</span>

<div class="viewcode-block" id="fit"><a class="viewcode-back" href="../../_autosummary/despasito.fit_parameters.fit.html#despasito.fit_parameters.fit">[docs]</a><span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="n">eos</span><span class="p">,</span> <span class="n">thermo_dict</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fit defined parameters for equation of state object with given experimental data. Each set of experimental data is converted to an object with the built in ability to evaluate its part of objective function.</span>
<span class="sd">    To add another type of supported experimental data, add a class to the fit_classes.py file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    eos : obj</span>
<span class="sd">        Equation of state output that writes pressure, max density, chemical potential, updates parameters, and evaluates objective functions. For parameter fitting algorithm See equation of state documentation for more details.</span>
<span class="sd">    thermo_dict : dict</span>
<span class="sd">        Dictionary of instructions for thermodynamic calculations and parameter fitting.</span>

<span class="sd">        - opt_params (dict) - Parameters used in basin fitting algorithm.</span>

<span class="sd">            - fit_bead (str) - Name of bead whose parameters are being fit, should be in bead list of beadconfig</span>
<span class="sd">            - fit_params (list[str]) - This list of contains the name of the parameter being fit (e.g. epsilon). See EOS mentation for supported parameter names. Cross interaction parameter names should be composed of parameter name and the other bead type, separated by an underscore (e.g. epsilon_CO2).</span>

<span class="sd">        - bounds (numpy.ndarray) - List of length equal to fit_params with lists of pairs for minimum and maximum bounds of parameter being fit. Defaults are broad, recommend specification.</span>
<span class="sd">        - exp_data (dict) - This dictionary is made up of a dictionary for each data set that the parameters are fit to. Each dictionary is converted into an object and saved back to this structure before parameter fitting begins. Each key is an arbitrary string used to identify the data set and used later in reporting objective function values during the fitting process. See data type objects for more details.</span>

<span class="sd">            - name (str) - One of the supported data type objects to fit parameters</span>

<span class="sd">        - beadparams0 (list[float]), Optional - Initial guess in parameter. If one is not provided, a guess is made based on the type of parameter from eos object.</span>
<span class="sd">        - output_file (str), Optional - Output file name</span>
<span class="sd">        - basin_dict (dict), Optional - kwargs used in scipy.optimize.basinhopping</span>

<span class="sd">            - niter (int) - Number of basin hopping iterations</span>
<span class="sd">            - T (float) - Temperature parameter, should be comparable to separation between local minima (i.e. the “height” of the walls separating values).</span>
<span class="sd">            - take_step (obj) - Callable object that includes custom routine that produces attribute stepsize</span>
<span class="sd">            - niter_success (int) - Stop run if minimum stays the same for this many iterations</span>

<span class="sd">        - minimizer_dict (dict), Optional - Dictionary used to define minimization type and the associated options.</span>

<span class="sd">            - method (str) - Method available to scipy.optimize.minimize</span>
<span class="sd">            - options (dict) - This dictionary contains the kwargs available to the chosen method</span>
<span class="sd">  </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Output file saved in current working directory</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

    <span class="c1"># Extract relevent quantities from thermo_dict</span>
    <span class="n">keys_del</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">thermo_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Extract inputs</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;opt_params&quot;</span><span class="p">:</span>
            <span class="n">opt_params</span>  <span class="o">=</span> <span class="n">thermo_dict</span><span class="p">[</span><span class="s2">&quot;opt_params&quot;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;exp_data&quot;</span><span class="p">:</span>
            <span class="n">exp_data</span> <span class="o">=</span> <span class="n">thermo_dict</span><span class="p">[</span><span class="s2">&quot;exp_data&quot;</span><span class="p">]</span>
        <span class="c1"># Optional inputs</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;beadparams0&quot;</span><span class="p">:</span>
            <span class="n">beadparams0</span> <span class="o">=</span> <span class="n">thermo_dict</span><span class="p">[</span><span class="s2">&quot;beadparams0&quot;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;output_file&quot;</span><span class="p">:</span>
            <span class="n">output_file</span> <span class="o">=</span> <span class="n">thermo_dict</span><span class="p">[</span><span class="s2">&quot;output_file&quot;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;bounds&quot;</span><span class="p">:</span>
            <span class="n">bounds</span> <span class="o">=</span> <span class="n">thermo_dict</span><span class="p">[</span><span class="s2">&quot;bounds&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">keys_del</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys_del</span><span class="p">:</span>
        <span class="n">thermo_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">list</span><span class="p">(</span><span class="n">thermo_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Note: thermo_dict keys: </span><span class="si">{}</span><span class="s2">, were not used.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">thermo_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()))))</span>    

    <span class="c1"># Reformat exp. data into formatted dictionary</span>
    <span class="n">exp_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">pkgpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">data_classes</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)</span>
    <span class="n">type_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">pkgpath</span><span class="p">)</span> <span class="k">if</span> <span class="s2">&quot;.py&quot;</span> <span class="ow">in</span> <span class="n">f</span><span class="p">]</span>
    <span class="n">type_list</span> <span class="o">=</span> <span class="n">type_list</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;__init__.py&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">data_dict</span> <span class="ow">in</span> <span class="n">exp_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">fittype</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">exp_module</span> <span class="o">=</span> <span class="n">import_module</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="o">+</span><span class="n">fittype</span><span class="p">,</span><span class="n">package</span><span class="o">=</span><span class="s2">&quot;despasito.fit_parameters.data_classes&quot;</span><span class="p">)</span>
            <span class="n">data_class</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">exp_module</span><span class="p">,</span> <span class="s2">&quot;Data&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">type_list</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s2">&quot;No fit types&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">type_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">type_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">tmp</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">type_list</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s2">&quot;The experimental data type, &#39;&quot;</span><span class="o">+</span><span class="n">fittype</span><span class="o">+</span><span class="s2">&quot;&#39;, was not found</span><span class="se">\n</span><span class="s2">The following calculation types are supported: &quot;</span><span class="o">+</span><span class="n">tmp</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">instance</span> <span class="o">=</span> <span class="n">data_class</span><span class="p">(</span><span class="n">data_dict</span><span class="p">)</span>
            <span class="n">exp_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">instance</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;Data set, </span><span class="si">{}</span><span class="s2">, did not properly initiate object&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>

    <span class="c1"># Generate initial guess for parameters if none was given</span>
    <span class="k">if</span> <span class="s2">&quot;beadparams0&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">thermo_dict</span><span class="p">:</span>
        <span class="n">beadparams0</span> <span class="o">=</span> <span class="n">eos</span><span class="o">.</span><span class="n">param_guess</span><span class="p">(</span><span class="n">opt_params</span><span class="p">[</span><span class="s2">&quot;fit_params&quot;</span><span class="p">])</span>

    <span class="c1"># Options for basin hopping</span>
    <span class="n">basin_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;niter&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;niter_success&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
    <span class="k">if</span> <span class="s2">&quot;basin_dict&quot;</span> <span class="ow">in</span> <span class="n">thermo_dict</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">thermo_dict</span><span class="p">[</span><span class="s2">&quot;basin_dict&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">basin_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="c1"># Set up options for minimizer in basin hopping</span>
    <span class="n">minimizer_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s1">&#39;nelder-mead&#39;</span><span class="p">,</span> <span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;maxiter&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">}}</span>
    <span class="k">if</span> <span class="s2">&quot;minimizer_dict&quot;</span> <span class="ow">in</span> <span class="n">thermo_dict</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">thermo_dict</span><span class="p">[</span><span class="s2">&quot;minimizer_dict&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;method&quot;</span><span class="p">:</span>
                <span class="n">minimizer_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;options&quot;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">key2</span><span class="p">,</span> <span class="n">value2</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">minimizer_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">key2</span><span class="p">]</span> <span class="o">=</span> <span class="n">value2</span>
  
    <span class="c1"># NoteHere: how is this array generated? stepmag = np.array([550.0, 26.0, 4.0e-10, 0.45, 500.0, 150.0e-30, 550.0])</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;stepsize&quot;</span> <span class="ow">in</span> <span class="n">basin_dict</span><span class="p">:</span>
        	<span class="n">stepsize</span> <span class="o">=</span> <span class="n">basin_dict</span><span class="p">[</span><span class="s2">&quot;stepsize&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
        	<span class="n">stepsize</span> <span class="o">=</span> <span class="mf">0.1</span>
        <span class="n">stepmag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bounds</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">basin_dict</span><span class="p">[</span><span class="s2">&quot;take_step&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ff</span><span class="o">.</span><span class="n">BasinStep</span><span class="p">(</span><span class="n">stepmag</span><span class="p">,</span> <span class="n">stepsize</span><span class="o">=</span><span class="n">stepsize</span><span class="p">)</span>
        <span class="n">custombounds</span> <span class="o">=</span> <span class="n">ff</span><span class="o">.</span><span class="n">BasinBounds</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
    	<span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Could not initialize BasinStep and/or BasinBounds&quot;</span><span class="p">)</span>

    <span class="c1"># Run Parameter Fitting</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">spo</span><span class="o">.</span><span class="n">basinhopping</span><span class="p">(</span><span class="n">ff</span><span class="o">.</span><span class="n">compute_SAFT_obj</span><span class="p">,</span> <span class="n">beadparams0</span><span class="p">,</span> <span class="o">**</span><span class="n">basin_dict</span><span class="p">,</span> <span class="n">accept_test</span><span class="o">=</span><span class="n">custombounds</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">minimizer_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">opt_params</span><span class="p">,</span> <span class="n">eos</span><span class="p">,</span> <span class="n">exp_dict</span><span class="p">),</span><span class="o">**</span><span class="n">minimizer_dict</span><span class="p">})</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Fitting terminated:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">message</span><span class="p">))</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">message</span><span class="p">))</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Best Fit Parameters&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;    Obj. Value: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">fun</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">opt_params</span><span class="p">[</span><span class="s2">&quot;fit_params&quot;</span><span class="p">])):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;    </span><span class="si">{}</span><span class="s2"> </span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">opt_params</span><span class="p">[</span><span class="s2">&quot;fit_bead&quot;</span><span class="p">],</span><span class="n">opt_params</span><span class="p">[</span><span class="s2">&quot;fit_params&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span><span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

    <span class="k">except</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The parameter fitting failed&quot;</span><span class="p">)</span></div>

</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Jennifer A Clark. Project structure based on the Computational Molecular Science Python Cookiecutter version 1.0

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>